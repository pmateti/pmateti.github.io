<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WhiteBoard Project using C RPC: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WhiteBoard Project using C RPC
   </div>
   <div id="projectbrief">A Project in Distributed Computing at IIIT-Delhi</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">WhiteBoard Project using C RPC Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Please read <a href="../7370projects.html">DIC Projects</a> first. This <code>0README</code> is a supplement to the lectures. It describes a bit of the philosophy behind the course and some details of the source code given to you as a start.</p>
<h1>Prerequisites </h1>
<p>This course expects that you are already comfortable in the use of networked machines based on Linux/Unix and X11. Learn to login to remote machines via ssh without having to interactively type your password each time; read <a href="http://cecs.wright.edu/~pmateti/Courses/2350/Labs/Network/NetworkLab.html#ssh">2350/ NetworkLab #ssh</a></p>
<p>Students whose Linux OS programming skills are rusty should study examples for {<code>alarm, fork, pipes, signals, bash</code> scripting} much simpler than what you see in our project files. At WSU, we expect CEG 4350/6350 OS Internals and Design to have taught these. Recommended book: W. Richard Stevens and Stephen A. Rago, Advanced Programming in the Unix Environment, Addison-Wesley, ISBN: 0-201-56317-7. <a href="http://www.apuebook.com/">http://www.apuebook.com/</a></p>
<p>Some of you worry this is C and not C++. C is a subset of C++. Also, the code does use lower-than-what-is-typical-in-C++ libraries. One of the goals of this course: Expose you to the basics of systems programming relevant to distributed computing. If you know C++ well enough, you should be able to fully understand C. Some quick equiv C v C++: <code>malloc/free</code> v <code>new/delete</code> mem allocation; <code>static</code> v <code>private</code> scope; <code>static</code> v <code>static</code> life time; <code>e1? e2 : e3</code> v <code>e1? e2 : e3</code> conditional expression;</p>
<p>RPC background is not expected. Several of the RPC lib procedures will be discussed in class. On Linux, these have become part of C std lib; on other OS you may have to explicitly give <code>-lrpcsvc</code> to the linker (<code>ld</code> of <code>gcc</code> or <code>g++</code>).</p>
<h1>How Does It Work? </h1>
<p>We will go over this in the lectures.</p>
<h1>Compilation + Make </h1>
<p>Expand the tar ball of source code <code>7370-WB-C-RPC-2014.tbz</code> using <code>tar xvvfj 7370-WB-C-RPC-2014.tbz</code></p>
<p>It is expected that you will study the source code closely. It is only 800+ lines. You should become so familiar with it <b>as if</b> you wrote it. The only exception is <a class="el" href="xwindow_8c.html">xwindow.c</a>; just read the comments.</p>
<p>The source code as given is ready to be built using <code>make</code>. There should be no compilation/link warnings except possibly in <code>rpcgen</code>-erated code. It should also run without any glitches. If these are not working out (i) in the OSIS Lab, report problems to me, (ii) on Linux systems elsewhere, I may be able to help, but there is too much ground to cover. Below <code>%</code> is my bash prompt as a non-root user.</p>
<h2>Original v Generated Files </h2>
<p>The following are the "original" (i.e., created by a human programmer) files.</p>
<div class="fragment"><div class="line">Makefile    the makefile for the project</div><div class="line">server.x    server rpc interface</div><div class="line">server.c    server specific code</div><div class="line">client.x    client rpc interface</div><div class="line">client.c    client specific code</div><div class="line">ed-script   to generate client_s.c from client_svc.c</div><div class="line">xwindow.c   a collection of simple X11 procedures</div><div class="line">transient.c gets a vacant program number</div></div><!-- fragment --><h2>Details </h2>
<ol type="1">
<li><code>rpcgen server.x</code> generates <code>server.h server_xdr.c server_clnt.c server_svc.c</code></li>
<li><code>rpcgen client.x</code> generates <code>client.h client_xdr.c client_clnt.c client_svc.c</code></li>
<li><code>client_s.c</code> is a minor variation of <code>client_svc.c</code> mechanically produced by running an editor script on <code>client_svc.c</code>. We insert <code>startclient(...)</code> just above the <code>svcrun()</code> line.</li>
<li>Just the <code><a class="el" href="xwindow_8c.html">xwindow.c</a></code> can be compiled as a stand-alone program <code>xwindow7370</code> to check for X11 problems.</li>
<li>Note the use of <code>static int i</code> within procedures; such an <code>i</code> is not allocated on the stack. This makes <code>i</code> "stay/live" even after that procedure returns.</li>
<li>Keep the compiler flags <code>-Wall -ansi -pedantic -std=c99</code> on; read-up on what these do. There should be zero errors/ warnings. The <code>rpcgen</code> generated code unfortunately is not as kosher. Note also that non-Linux OS may have ancient rpcgens that generate even worse code so far as these flags are concerned.</li>
<li>Our code uses <code>alarm</code>, <code>fork</code>, <code>pipe</code> s, and <code>signal</code> s. Our (simple minded) use of signals requires <code>-D_BSD_SIGNALS.</code></li>
<li>The <code>% make</code> will compile the source code file <code><a class="el" href="deregall_8c.html">deregall.c</a></code> into a program named <code>deregall7370</code>. This can de-register transient RPC processes.</li>
<li>To clean up the project dir, invoke <code>% make clean</code>.</li>
<li>To archive a version, do <code>% make tar</code></li>
</ol>
<h1>How to Run It </h1>
<p>Some of you may wish to use your own Linux boxes for 7370 work. But Linux installations out-of-the-box are typically not "open" enough for us. Check your Linux Setup first.</p>
<ol type="1">
<li>Host names below can be IP addresses (better/ simpler actually). In the OSIS lab, we use private IP addresses <code>192.168.17.*</code></li>
<li>In the source code as given: The server is one process running on host H1. The client consists of two processes both running on host H2. It is ok, but not desirable that H1 == H2. H2 is where the X11 server is also running, using the bash-equaivalent of <code>export DISPLAY=H2:0.0</code></li>
<li>Run the "server" as a background process on a machine of your choice.\ <code>% server7370 &amp;</code></li>
<li>Run the "client" from one or more machines of your choice. The client needs four arguments:\ <code>% client7370 &lt;srv-mchn-nm&gt; &lt;wb-nm&gt; &lt;wb-disp&gt; &lt;color&gt;=\\ =&lt;srv-mchn-nm&gt;</code> is the name of the machine running your server; <code>&lt;wb-nm&gt;</code> is the name of the whiteboard you wish to create/join; <code>&lt;wb-disp&gt;</code> is the name of the machine you are logged in for the X11 display; <code>&lt;color&gt;</code> is a 6-hex-digit X11 RGB color number for lines of this client;</li>
</ol>
<p>Here are a few bash procedures: A simple "smoke test" with all the processes running on <code>localhost</code> and kill all and deregister 7370 related processes. Read <code>man killall</code> and <code>man pkill</code>.</p>
<div class="fragment"><div class="line">smokeTest7370() {</div><div class="line">  ./server7370 &amp;</div><div class="line">  echo -n Server started, press Return to continue; read</div><div class="line">  ./client7370 localhost b0 localhost ff0000 &amp; # RGB=ff0000 = red</div><div class="line">  echo -n client started, press Return to continue; read</div><div class="line">  ./client7370 localhost b0 localhost ff00 &amp; # RGB=00ff00 = green</div><div class="line">  echo -n client started; press Return to continue; read</div><div class="line">  ./client7370 localhost b0 localhost ff &amp; # RGB=0000ff = blue</div><div class="line">  echo -n client started, press Return to continue; read</div><div class="line">  rpcinfo -p</div><div class="line">}</div><div class="line"></div><div class="line">killall7370() {</div><div class="line">  killall -q server7370 client7370</div><div class="line">  ./deregall7370 536871065  # change this to your server num</div><div class="line">  ./deregall7370</div><div class="line">  rpcinfo -p</div><div class="line">}</div><div class="line"></div><div class="line">freshStart7370() {</div><div class="line">  killall7370</div><div class="line">  smokeTest7370</div><div class="line">  ps</div><div class="line">  rpcinfo -p</div><div class="line">}</div></div><!-- fragment --><p>Locate where <code>rpcinfo</code> is. Perhaps it is in <code>/usr/sbin</code> instead of <code>/usr/bin</code>. Read its man page. Here is an example invocation on Linux machines:</p>
<div class="fragment"><div class="line">% rpcinfo -p</div><div class="line">   program vers proto   port</div><div class="line">    100000    2   tcp    111  portmapper</div><div class="line">    100000    2   udp    111  portmapper</div><div class="line">    ... more lines</div></div><!-- fragment --><p>Do the above after a fresh reboot. This shows the presence of other standard RPC processes. After you "close" your WB project demo, the list then should be the same.</p>
<h1>Miscellaneous </h1>
<ol type="1">
<li>Learn to use <code>backtrace()</code>; it will offset the time you may otherwise waste in debugging. <a href="http://www.gnu.org/software/libc/manual/html_node/Backtraces.html">http://www.gnu.org/software/libc/manual/html_node/Backtraces.html</a></li>
<li>See what libraries are actually in use: <code>% ldd client7370 server7370</code> </li>
</ol>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Jan 22 2020 15:23:57 for WhiteBoard Project using C RPC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>

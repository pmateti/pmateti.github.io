<h2><span class="mw-headline"
id="Kotlin"><a href="/wiki/Category:Kotlin"
title="Category:Kotlin">Kotlin</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=15_Puzzle_Game&amp;action=edit&amp;section=24"
title="Edit section:
Kotlin">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="examplemeta translation"><b>Translation of</b>: <a href="#Java">Java</a></div>
<pre class="scala highlighted_source"><span class="co1">// version 1.1.3</span><br />&#160;<br /><a href="http://scala-lang.org"><span class="kw1">import</span></a> java.<span class="me1">awt</span>.<span class="me1">BorderLayout</span><br /><a href="http://scala-lang.org"><span class="kw1">import</span></a> java.<span class="me1">awt</span>.<span class="me1">Color</span><br /><a href="http://scala-lang.org"><span class="kw1">import</span></a> java.<span class="me1">awt</span>.<span class="me1">Dimension</span><br /><a href="http://scala-lang.org"><span class="kw1">import</span></a> java.<span class="me1">awt</span>.<span class="me1">Font</span><br /><a href="http://scala-lang.org"><span class="kw1">import</span></a> java.<span class="me1">awt</span>.<span class="me1">Graphics</span><br /><a href="http://scala-lang.org"><span class="kw1">import</span></a> java.<span class="me1">awt</span>.<span class="me1">Graphics2D</span><br /><a href="http://scala-lang.org"><span class="kw1">import</span></a> java.<span class="me1">awt</span>.<span class="me1">RenderingHints</span><br /><a href="http://scala-lang.org"><span class="kw1">import</span></a> java.<span class="me1">awt</span>.<span class="me1">event</span>.<span class="me1">MouseAdapter</span><br /><a href="http://scala-lang.org"><span class="kw1">import</span></a> java.<span class="me1">awt</span>.<span class="me1">event</span>.<span class="me1">MouseEvent</span><br /><a href="http://scala-lang.org"><span class="kw1">import</span></a> java.<span class="me1">util</span>.<span class="me1">Random</span><br /><a href="http://scala-lang.org"><span class="kw1">import</span></a> javax.<span class="me1">swing</span>.<span class="me1">JFrame</span><br /><a href="http://scala-lang.org"><span class="kw1">import</span></a> javax.<span class="me1">swing</span>.<span class="me1">JPanel</span><br /><a href="http://scala-lang.org"><span class="kw1">import</span></a> javax.<span class="me1">swing</span>.<span class="me1">SwingUtilities</span><br />&#160;<br /><a href="http://scala-lang.org"><span class="kw1">class</span></a> FifteenPuzzle<span class="br0">&#40;</span>dim<span class="sy0">:</span> Int, <a href="http://scala-lang.org"><span class="kw1">val</span></a> margin<span class="sy0">:</span> Int<span class="br0">&#41;</span> <span class="sy0">:</span> JPanel<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />&#160;<br />    <a href="http://scala-lang.org"><span class="kw1">private</span></a> <a href="http://scala-lang.org"><span class="kw1">val</span></a> rand <span class="sy0">=</span> Random<span class="br0">&#40;</span><span class="br0">&#41;</span><br />    <a href="http://scala-lang.org"><span class="kw1">private</span></a> <a href="http://scala-lang.org"><span class="kw1">val</span></a> tiles <span class="sy0">=</span> IntArray<span class="br0">&#40;</span><span class="nu0">16</span><span class="br0">&#41;</span><br />    <a href="http://scala-lang.org"><span class="kw1">private</span></a> <a href="http://scala-lang.org"><span class="kw1">val</span></a> tileSize <span class="sy0">=</span> <span class="br0">&#40;</span>dim - <span class="nu0">2</span> <span class="sy0">*</span> margin<span class="br0">&#41;</span> / <span class="nu0">4</span><br />    <a href="http://scala-lang.org"><span class="kw1">private</span></a> <a href="http://scala-lang.org"><span class="kw1">val</span></a> gridSize <span class="sy0">=</span> tileSize <span class="sy0">*</span> <span class="nu0">4</span><br />    <a href="http://scala-lang.org"><span class="kw1">private</span></a> <a href="http://scala-lang.org"><span class="kw1">var</span></a> blankPos <span class="sy0">=</span> <span class="nu0">0</span><br />&#160;<br />    init <span class="br0">&#123;</span><br />        preferredSize <span class="sy0">=</span> Dimension<span class="br0">&#40;</span>dim, dim<span class="br0">&#41;</span><br />        background <span class="sy0">=</span> Color.<span class="me1">white</span><br />        <a href="http://scala-lang.org"><span class="kw1">val</span></a> cornflowerBlue <span class="sy0">=</span> 0x6495ED<br />        foreground <span class="sy0">=</span> Color<span class="br0">&#40;</span>cornflowerBlue<span class="br0">&#41;</span><br />        font <span class="sy0">=</span> Font<span class="br0">&#40;</span><span class="st0">&quot;SansSerif&quot;</span>, Font.<span class="me1">BOLD</span>, <span class="nu0">60</span><span class="br0">&#41;</span><br />&#160;<br />        addMouseListener<span class="br0">&#40;</span><a href="http://scala-lang.org"><span class="kw1">object</span></a> <span class="sy0">:</span> MouseAdapter<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />            <a href="http://scala-lang.org"><span class="kw1">override</span></a> fun mousePressed<span class="br0">&#40;</span>e<span class="sy0">:</span> MouseEvent<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />                <a href="http://scala-lang.org"><span class="kw1">val</span></a> ex <span class="sy0">=</span> e.<span class="me1">x</span> - margin<br />                <a href="http://scala-lang.org"><span class="kw1">val</span></a> ey <span class="sy0">=</span> e.<span class="me1">y</span> - margin<br />                <a href="http://scala-lang.org"><span class="kw1">if</span></a> <span class="br0">&#40;</span>ex <span class="sy0">!</span>in <span class="nu0">0</span>..<span class="me1">gridSize</span> || ey <span class="sy0">!</span>in <span class="nu0">0</span>..<span class="me1">gridSize</span><span class="br0">&#41;</span> <a href="http://scala-lang.org"><span class="kw1">return</span></a><br />&#160;<br />                <a href="http://scala-lang.org"><span class="kw1">val</span></a> c1 <span class="sy0">=</span> ex / tileSize<br />                <a href="http://scala-lang.org"><span class="kw1">val</span></a> r1 <span class="sy0">=</span> ey / tileSize<br />                <a href="http://scala-lang.org"><span class="kw1">val</span></a> c2 <span class="sy0">=</span> blankPos <span class="sy0">%</span> <span class="nu0">4</span><br />                <a href="http://scala-lang.org"><span class="kw1">val</span></a> r2 <span class="sy0">=</span> blankPos / <span class="nu0">4</span><br />                <a href="http://scala-lang.org"><span class="kw1">if</span></a> <span class="br0">&#40;</span><span class="br0">&#40;</span>c1 <span class="sy0">==</span> c2 <span class="sy0">&amp;&amp;</span> Math.<span class="me1">abs</span><span class="br0">&#40;</span>r1 - r2<span class="br0">&#41;</span> <span class="sy0">==</span> <span class="nu0">1</span><span class="br0">&#41;</span> ||<br />                    <span class="br0">&#40;</span>r1 <span class="sy0">==</span> r2 <span class="sy0">&amp;&amp;</span> Math.<span class="me1">abs</span><span class="br0">&#40;</span>c1 - c2<span class="br0">&#41;</span> <span class="sy0">==</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />                    <a href="http://scala-lang.org"><span class="kw1">val</span></a> clickPos <span class="sy0">=</span> r1 <span class="sy0">*</span> <span class="nu0">4</span> + c1<br />                    tiles<span class="br0">&#91;</span>blankPos<span class="br0">&#93;</span> <span class="sy0">=</span> tiles<span class="br0">&#91;</span>clickPos<span class="br0">&#93;</span><br />                    tiles<span class="br0">&#91;</span>clickPos<span class="br0">&#93;</span> <span class="sy0">=</span> <span class="nu0">0</span><br />                    blankPos <span class="sy0">=</span> clickPos<br />                <span class="br0">&#125;</span><br />                repaint<span class="br0">&#40;</span><span class="br0">&#41;</span><br />            <span class="br0">&#125;</span><br />        <span class="br0">&#125;</span><span class="br0">&#41;</span><br />&#160;<br />        shuffle<span class="br0">&#40;</span><span class="br0">&#41;</span><br />    <span class="br0">&#125;</span><br />&#160;<br />    <a href="http://scala-lang.org"><span class="kw1">private</span></a> fun shuffle<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        <a href="http://scala-lang.org"><span class="kw1">do</span></a> <span class="br0">&#123;</span><br />            reset<span class="br0">&#40;</span><span class="br0">&#41;</span><br />            <span class="co1">// don't include the blank space in the shuffle,</span><br />            <span class="co1">// leave it in the home position</span><br />            <a href="http://scala-lang.org"><span class="kw1">var</span></a> n <span class="sy0">=</span> <span class="nu0">15</span><br />            <a href="http://scala-lang.org"><span class="kw1">while</span></a> <span class="br0">&#40;</span>n <span class="sy0">&gt;</span> <span class="nu0">1</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />                <a href="http://scala-lang.org"><span class="kw1">val</span></a> r <span class="sy0">=</span> rand.<span class="me1">nextInt</span><span class="br0">&#40;</span>n--<span class="br0">&#41;</span><br />                <a href="http://scala-lang.org"><span class="kw1">val</span></a> tmp <span class="sy0">=</span> tiles<span class="br0">&#91;</span>r<span class="br0">&#93;</span><br />                tiles<span class="br0">&#91;</span>r<span class="br0">&#93;</span> <span class="sy0">=</span> tiles<span class="br0">&#91;</span>n<span class="br0">&#93;</span><br />                tiles<span class="br0">&#91;</span>n<span class="br0">&#93;</span> <span class="sy0">=</span> tmp<br />            <span class="br0">&#125;</span><br />        <span class="br0">&#125;</span> <a href="http://scala-lang.org"><span class="kw1">while</span></a> <span class="br0">&#40;</span><span class="sy0">!</span>isSolvable<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />    <span class="br0">&#125;</span><br />&#160;<br />    <a href="http://scala-lang.org"><span class="kw1">private</span></a> fun reset<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        <a href="http://scala-lang.org"><span class="kw1">for</span></a> <span class="br0">&#40;</span>i in <span class="nu0">0</span> until tiles.<span class="me1">size</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />            tiles<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="sy0">=</span> <span class="br0">&#40;</span>i + <span class="nu0">1</span><span class="br0">&#41;</span> <span class="sy0">%</span> tiles.<span class="me1">size</span><br />        <span class="br0">&#125;</span><br />        blankPos <span class="sy0">=</span> <span class="nu0">15</span><br />    <span class="br0">&#125;</span><br />&#160;<br />    <span class="coMULTI">/*  Only half the permutations of the puzzle are solvable.<br />&#160;<br />        Whenever a tile is preceded by a tile with higher value it counts<br />        as an inversion. In our case, with the blank space in the home<br />        position, the number of inversions must be even for the puzzle<br />        to be solvable.<br />    */</span><br />&#160;<br />    <a href="http://scala-lang.org"><span class="kw1">private</span></a> fun isSolvable<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">:</span> Boolean <span class="br0">&#123;</span><br />        <a href="http://scala-lang.org"><span class="kw1">var</span></a> countInversions <span class="sy0">=</span> <span class="nu0">0</span><br />        <a href="http://scala-lang.org"><span class="kw1">for</span></a> <span class="br0">&#40;</span>i in <span class="nu0">0</span> until <span class="nu0">15</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />            <span class="br0">&#40;</span><span class="nu0">0</span> until i<span class="br0">&#41;</span><br />                .<span class="me1">filter</span> <span class="br0">&#123;</span> tiles<span class="br0">&#91;</span>it<span class="br0">&#93;</span> <span class="sy0">&gt;</span> tiles<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="br0">&#125;</span><br />                .<span class="me1">forEach</span> <span class="br0">&#123;</span> countInversions++ <span class="br0">&#125;</span><br />        <span class="br0">&#125;</span><br />        <a href="http://scala-lang.org"><span class="kw1">return</span></a> countInversions <span class="sy0">%</span> <span class="nu0">2</span> <span class="sy0">==</span> <span class="nu0">0</span><br />    <span class="br0">&#125;</span><br />&#160;<br />    <a href="http://scala-lang.org"><span class="kw1">private</span></a> fun drawGrid<span class="br0">&#40;</span>g<span class="sy0">:</span> Graphics2D<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        <a href="http://scala-lang.org"><span class="kw1">for</span></a> <span class="br0">&#40;</span>i in <span class="nu0">0</span> until tiles.<span class="me1">size</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />            <a href="http://scala-lang.org"><span class="kw1">if</span></a> <span class="br0">&#40;</span>tiles<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">&#41;</span> continue<br />&#160;<br />            <a href="http://scala-lang.org"><span class="kw1">val</span></a> r <span class="sy0">=</span> i / <span class="nu0">4</span><br />            <a href="http://scala-lang.org"><span class="kw1">val</span></a> c <span class="sy0">=</span> i <span class="sy0">%</span> <span class="nu0">4</span><br />            <a href="http://scala-lang.org"><span class="kw1">val</span></a> x <span class="sy0">=</span> margin + c <span class="sy0">*</span> tileSize<br />            <a href="http://scala-lang.org"><span class="kw1">val</span></a> y <span class="sy0">=</span> margin + r <span class="sy0">*</span> tileSize<br />&#160;<br />            <a href="http://scala-lang.org"><span class="kw1">with</span></a><span class="br0">&#40;</span>g<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />                color <span class="sy0">=</span> foreground<br />                fillRoundRect<span class="br0">&#40;</span>x, y, tileSize, tileSize, <span class="nu0">25</span>, <span class="nu0">25</span><span class="br0">&#41;</span><br />                color <span class="sy0">=</span> Color.<span class="me1">black</span><br />                drawRoundRect<span class="br0">&#40;</span>x, y, tileSize, tileSize, <span class="nu0">25</span>, <span class="nu0">25</span><span class="br0">&#41;</span><br />                color <span class="sy0">=</span> Color.<span class="me1">white</span><br />            <span class="br0">&#125;</span><br />            drawCenteredString<span class="br0">&#40;</span>g, tiles<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">toString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, x, y<span class="br0">&#41;</span><br />        <span class="br0">&#125;</span><br />    <span class="br0">&#125;</span><br />&#160;<br />    <a href="http://scala-lang.org"><span class="kw1">private</span></a> fun drawCenteredString<span class="br0">&#40;</span>g<span class="sy0">:</span> Graphics2D, s<span class="sy0">:</span> String, x<span class="sy0">:</span> Int, y<span class="sy0">:</span> Int<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        <a href="http://scala-lang.org"><span class="kw1">val</span></a> fm <span class="sy0">=</span> g.<span class="me1">fontMetrics</span><br />        <a href="http://scala-lang.org"><span class="kw1">val</span></a> asc <span class="sy0">=</span> fm.<span class="me1">ascent</span><br />        <a href="http://scala-lang.org"><span class="kw1">val</span></a> des <span class="sy0">=</span> fm.<span class="me1">descent</span><br />&#160;<br />        <a href="http://scala-lang.org"><span class="kw1">val</span></a> xx <span class="sy0">=</span> x + <span class="br0">&#40;</span>tileSize - fm.<span class="me1">stringWidth</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span><span class="br0">&#41;</span> / <span class="nu0">2</span><br />        <a href="http://scala-lang.org"><span class="kw1">val</span></a> yy <span class="sy0">=</span> y + <span class="br0">&#40;</span>asc + <span class="br0">&#40;</span>tileSize - <span class="br0">&#40;</span>asc + des<span class="br0">&#41;</span><span class="br0">&#41;</span> / <span class="nu0">2</span><span class="br0">&#41;</span><br />&#160;<br />        g.<span class="me1">drawString</span><span class="br0">&#40;</span>s, xx, yy<span class="br0">&#41;</span><br />    <span class="br0">&#125;</span><br />&#160;<br />    <a href="http://scala-lang.org"><span class="kw1">override</span></a> fun paintComponent<span class="br0">&#40;</span>gg<span class="sy0">:</span> Graphics<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        <a href="http://scala-lang.org"><span class="kw1">super</span></a>.<span class="me1">paintComponent</span><span class="br0">&#40;</span>gg<span class="br0">&#41;</span><br />        <a href="http://scala-lang.org"><span class="kw1">val</span></a> g <span class="sy0">=</span> gg as Graphics2D<br />        g.<span class="me1">setRenderingHint</span><span class="br0">&#40;</span>RenderingHints.<span class="me1">KEY_ANTIALIASING</span>,<br />            RenderingHints.<span class="me1">VALUE_ANTIALIAS_ON</span><span class="br0">&#41;</span><br />        drawGrid<span class="br0">&#40;</span>g<span class="br0">&#41;</span><br />    <span class="br0">&#125;</span><br /><span class="br0">&#125;</span><br />&#160;<br />fun main<span class="br0">&#40;</span>args<span class="sy0">:</span> Array<span class="sy0">&lt;</span>String<span class="sy0">&gt;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />    SwingUtilities.<span class="me1">invokeLater</span> <span class="br0">&#123;</span><br />        <a href="http://scala-lang.org"><span class="kw1">val</span></a> f <span class="sy0">=</span> JFrame<span class="br0">&#40;</span><span class="br0">&#41;</span><br />        <a href="http://scala-lang.org"><span class="kw1">with</span></a><span class="br0">&#40;</span>f<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />            defaultCloseOperation <span class="sy0">=</span> JFrame.<span class="me1">EXIT_ON_CLOSE</span><br />            title <span class="sy0">=</span> <span class="st0">&quot;Fifteen Puzzle&quot;</span><br />            isResizable <span class="sy0">=</span> <a href="http://scala-lang.org"><span class="kw1">false</span></a><br />            add<span class="br0">&#40;</span>FifteenPuzzle<span class="br0">&#40;</span><span class="nu0">640</span>, <span class="nu0">80</span><span class="br0">&#41;</span>, BorderLayout.<span class="me1">CENTER</span><span class="br0">&#41;</span><br />            pack<span class="br0">&#40;</span><span class="br0">&#41;</span><br />            setLocationRelativeTo<span class="br0">&#40;</span><a href="http://scala-lang.org"><span class="kw1">null</span></a><span class="br0">&#41;</span><br />            isVisible <span class="sy0">=</span> <a href="http://scala-lang.org"><span class="kw1">true</span></a><br />        <span class="br0">&#125;</span><br />    <span class="br0">&#125;</span><br /><span class="br0">&#125;</span></pre>

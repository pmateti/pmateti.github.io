<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-10-13 Sun 20:06 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Kernel Exploits Overview</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Prabhaker Mateti" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<style> P,li {text-align: justify} code {color: brown;} @media screen {BODY {margin: 10%} }</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="../"> UP </a>
 |
 <a accesskey="H" href="../../Top/index.html"> HOME </a>
</div><div id="preamble" class="status">
<a href="../../"> ../../</a> | <a href=./>NoSlides</a>
</div>
<div id="content">
<h1 class="title">Kernel Exploits Overview</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org9ddca4c">1. Objectives</a></li>
<li><a href="#org940897b">2. Kernel Exploit Classics</a>
<ul>
<li><a href="#org1df66c3">2.1. Privilege Escalation Technique</a></li>
<li><a href="#orge9ff257">2.2. BackDoors</a></li>
<li><a href="#orgbd25ad3">2.3. RootKits</a></li>
<li><a href="#orgb3a9487">2.4. RaceConditions</a></li>
</ul>
</li>
<li><a href="#orgc8224b2">3. Sym Link Attack</a></li>
<li><a href="#orgac3058c">4. Viruses, Worms, Trojans</a></li>
<li><a href="#orgb136c81">5. Recent (2017+) Kernel Exploits</a>
<ul>
<li><a href="#org68381c1">5.1. Stack Clash</a></li>
<li><a href="#org87019ed">5.2. Spectre</a></li>
<li><a href="#orgf9d5af8">5.3. Meltdown</a></li>
<li><a href="#orgb1bddbe">5.4. Dirty COW</a></li>
<li><a href="#org49ba6de">5.5. CVE-2017-18202 Local DoS Vulnerability</a></li>
<li><a href="#orge85868f">5.6. CVE-2017-15126</a></li>
<li><a href="#org275b962">5.7. CVE-2017-1000253</a></li>
<li><a href="#org8de4633">5.8. CVE  1999 to 2019</a></li>
</ul>
</li>
<li><a href="#orga5f0932">6. References</a>
<ul>
<li><a href="#org22085c9">6.1. References</a></li>
<li><a href="#org16e8fb9">6.2. References</a></li>
<li><a href="#org70cf60b">6.3. References</a></li>
<li><a href="#org95f3aa5">6.4. References</a></li>
<li><a href="#org4cbede5">6.5. Related Lecture Notes</a></li>
</ul>
</li>
<li><a href="#orgce4227c">7. End</a></li>
</ul>
</div>
</div>


<div id="outline-container-org9ddca4c" class="outline-2">
<h2 id="org9ddca4c"><span class="section-number-2">1</span> Objectives</h2>
<div class="outline-text-2" id="text-1">
<ol class="org-ol">
<li>Objective: Over the years there have been many kernel bugs.  In the
1000s.  This page and related articles give brief technical
descriptions of a few kernel vulnerabilities.  Discovered in 2017+.
Or, classics.  Network related items are skipped.  Not exhaustive.</li>

<li>Objective: Provide technical descriptions accessible to students of
cyber security.  Have a <b>decent</b> technical understanding of the
vulnerability and the exploit.</li>

<li>Objective: Become familiar with CVE, and the description structure
of a CVE.  The CVEs shown here are a tiny selection.</li>

<li>Not-an-objective: To be able to provide fixes to such exploits.</li>
</ol>
</div>
</div>

<div id="outline-container-org940897b" class="outline-2">
<h2 id="org940897b"><span class="section-number-2">2</span> Kernel Exploit Classics</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org1df66c3" class="outline-3">
<h3 id="org1df66c3"><span class="section-number-3">2.1</span> Privilege Escalation Technique</h3>
<div class="outline-text-3" id="text-2-1">
<ol class="org-ol">
<li>Privilege escalation is a technique an attacker/ intruder almost
always attempts.  He arrives as an ordinary/ unprivileged user, and
gains super user privileges through exploiting a bug, or
configuration oversight.</li>
<li>How did he gain access even as an ordinary user?  This is a
separate and independent exploit &#x2013; e.g., via a stolen password.</li>
<li>A typical privilege escalation technique is through stack smashing,
or ROC.</li>

<li>Once super user access is obtained, the intruder can install
backdoors, rootkits, change permissions, etc.</li>

<li>Linux PIE/stack corruption (CVE-2017-1000253) A Local Privilege
Escalation.
<a href="https://www.qualys.com/2017/09/26/linux-pie-cve-2017-1000253/cve-2017-1000253.txt">https://www.qualys.com/2017/09/26/linux-pie-cve-2017-1000253/cve-2017-1000253.txt</a>
"An unprivileged local user with access to SUID (or otherwise
privileged) PIE binary could use this flaw to escalate their
privileges on the system."</li>
</ol>
</div>
</div>


<div id="outline-container-orge9ff257" class="outline-3">
<h3 id="orge9ff257"><span class="section-number-3">2.2</span> BackDoors</h3>
<div class="outline-text-3" id="text-2-2">
<ol class="org-ol">
<li>Backdoors is frequently an application issue.  But, there have been
kernel backdoors.   <a href="./BackDoors/">./BackDoors/</a></li>
<li><a href="https://freedom-to-tinker.com/2013/10/09/the-linux-backdoor-attempt-of-2003/">https://freedom-to-tinker.com/2013/10/09/the-linux-backdoor-attempt-of-2003/</a> Reference</li>
<li><a href="https://www.theregister.co.uk/2016/05/09/allwinners_allloser_custom_kernel_has_a_nasty_root_backdoor/">https://www.theregister.co.uk/2016/05/09/allwinners_allloser_custom_kernel_has_a_nasty_root_backdoor/</a>
ARM. Reference</li>
<li><a href="https://www.reddit.com/r/linux/comments/54in5s/the_nsa_has_tried_to_backdoor_linux_three_times/">https://www.reddit.com/r/linux/comments/54in5s/the_nsa_has_tried_to_backdoor_linux_three_times/</a> 2016. Recommended Reading</li>
<li><a href="https://www.wired.com/2016/01/hack-brief-years-old-linux-bug/">https://www.wired.com/2016/01/hack-brief-years-old-linux-bug/</a> 2016. Recommended Reading</li>
<li><a href="https://www.infoworld.com/article/2606776/hacking/155947-Biggest-baddest-boldest-software-backdoors-of-all-time.html">https://www.infoworld.com/article/2606776/hacking/155947-Biggest-baddest-boldest-software-backdoors-of-all-time.html</a> 2014. Recommended Reading</li>
</ol>
</div>
</div>

<div id="outline-container-orgbd25ad3" class="outline-3">
<h3 id="orgbd25ad3"><span class="section-number-3">2.3</span> RootKits</h3>
<div class="outline-text-3" id="text-2-3">
<ol class="org-ol">
<li><a href="./RootKits/">./RootKits/</a> Separate page</li>
</ol>
</div>
</div>

<div id="outline-container-orgb3a9487" class="outline-3">
<h3 id="orgb3a9487"><span class="section-number-3">2.4</span> RaceConditions</h3>
<div class="outline-text-3" id="text-2-4">
<ol class="org-ol">
<li><a href="./RaceConditions/">./RaceConditions/</a> Separate page</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgc8224b2" class="outline-2">
<h2 id="orgc8224b2"><span class="section-number-2">3</span> Sym Link Attack</h2>
<div class="outline-text-2" id="text-3">
<ol class="org-ol">
<li>"Symlink attack is one of the newest and easiest way of
exploitation as the attacker gets full root access to the entire
server from a compromised website.</li>

<li><a href="https://www.serveradminz.com/blog/the-vulnerable-symlink-attackan-awesome-way-for-a-hacker-the-prevention-methods/">https://www.serveradminz.com/blog/the-vulnerable-symlink-attackan-awesome-way-for-a-hacker-the-prevention-methods/</a>
By admin July 2016; {pm: Quite detailed}  Reference</li>

<li><a href="https://blog.sucuri.net/2013/05/from-a-site-compromise-to-full-root-access-symlinks-to-root-part-i.html">https://blog.sucuri.net/2013/05/from-a-site-compromise-to-full-root-access-symlinks-to-root-part-i.html</a>
2013 Reference</li>

<li><a href="http://groups.hcon.in/uploads/1/8/1/9/1819392/hga_bhashit_pandya_-_symlink_attack.pdf">http://groups.hcon.in/uploads/1/8/1/9/1819392/hga_bhashit_pandya_-_symlink_attack.pdf</a>,
Bhashit Pandya, Symlink Attack Tutorial, 201x, 30+ slides.  {pm:
Several minor errors}.  Recommended Reading.</li>
</ol>
</div>
</div>


<div id="outline-container-orgac3058c" class="outline-2">
<h2 id="orgac3058c"><span class="section-number-2">4</span> Viruses, Worms, Trojans</h2>
<div class="outline-text-2" id="text-4">
<ol class="org-ol">
<li>Linux malware includes viruses, trojans, worms.  At the level of
academic discussion, these are different.  But, virus is now a term
that combines all these and has become slag-equivalent to malware.</li>

<li>Malware often  arrives via networking.  But, it can also arrive via
files being opened/ copied, and USBD insertions.</li>

<li>Example: <a href="https://threats.kaspersky.com/ru/threat/Virus.Linux.Alaeda/">https://threats.kaspersky.com/ru/threat/Virus.Linux.Alaeda/</a> 2003? "Alaeda
is a non-resident virus. It infects systems running Linux, and is
written in Assembly. It infects .ELF format files in the current
directory.  When infecting, the virus modifies the entry point of
the original file, passing control to the infection routine. It
then modifies the file's .ELF header. Before infecting, the virus
checks to see if the computer is vulnerable. The .TXT part of the
file must also be the minimum size to infect.  The virus writes its
body to the .TXT section. The size of the file will not change,
making it hard to tell if files are infected.  Once the virus body
has delivered its payload, control is returned to the program
code. If a file is already infected, the virus will not re-infect
the file."</li>

<li><a href="https://en.wikipedia.org/wiki/Linux_malware">https://en.wikipedia.org/wiki/Linux_malware</a> Lists malware examples.
Required Reading.</li>
</ol>
</div>
</div>


<div id="outline-container-orgb136c81" class="outline-2">
<h2 id="orgb136c81"><span class="section-number-2">5</span> Recent (2017+) Kernel Exploits</h2>
<div class="outline-text-2" id="text-5">
<ol class="org-ol">
<li>Meltdown and Spectre are CPU vulnerabilities.</li>
<li>Should we expect an OS kernel to fix/ work-around such bugs?!</li>

<li><a href="https://github.com/xairy/kernel-exploits">https://github.com/xairy/kernel-exploits</a> "A bunch of
proof-of-concept exploits for the Linux kernel" 2016 &#x2013; current.</li>

<li>Kali Linux has a local copy of exploit-db exploits which make it
easier to search for local root exploits</li>
</ol>
</div>

<div id="outline-container-org68381c1" class="outline-3">
<h3 id="org68381c1"><span class="section-number-3">5.1</span> Stack Clash</h3>
<div class="outline-text-3" id="text-5-1">
<ol class="org-ol">
<li>A vulnerability in the memory management of OS was discovered in
2017, and named Stack Clash.  It can be exploited to execute
arbitrary code.</li>

<li>Qualys stack-clash.txt [see refs] provided a technically detailed
description.</li>

<li>"The idea of clashing the stack with another memory region is not
new: it was exploited a first time in 2005 and a second time
in 2010. After the 2010 exploit, Linux introduced a protection
against such exploits: the so-called stack guard-page. "</li>

<li>To understand stack-guard page: Understand syscalls  <code>mmap2,
   mprotect, clone</code>, etc.</li>

<li>"The exploits and proofs of concept that we developed in the course
of our research are all Local Privilege Escalations: an attacker
who has any kind of access to an affected system can exploit the
Stack Clash vulnerability and obtain full root privileges."</li>

<li><a href="https://www.cvedetails.com/cve/CVE-2017-1000364/">https://www.cvedetails.com/cve/CVE-2017-1000364/</a> "An issue was
discovered in the size of the stack guard page on Linux,
specifically a 4k stack guard page is not sufficiently large and
can be "jumped" over (the stack guard page is bypassed), this
affects Linux Kernel versions 4.11.5 and earlier (the stackguard
page was introduced in 2010)."  Reference.</li>

<li><a href="https://www.exploit-db.com/docs/english/17784-recursive-stack-overflows.pdf">https://www.exploit-db.com/docs/english/17784-recursive-stack-overflows.pdf</a>
Jumping the Guard Page for Fun and Profit, Recursive Stack Overflows;
25 slides, 201x.  Recommended Reading.</li>

<li><a href="https://blog.aquasec.com/bugs-gone-wild-container-stack-clash-and-cve-2017-1000253">https://blog.aquasec.com/bugs-gone-wild-container-stack-clash-and-cve-2017-1000253</a>
Recommended Reading.</li>
</ol>
</div>
</div>

<div id="outline-container-org87019ed" class="outline-3">
<h3 id="org87019ed"><span class="section-number-3">5.2</span> Spectre</h3>
<div class="outline-text-3" id="text-5-2">
<ol class="org-ol">
<li>Meltdown and Spectre exploit design errors in modern CPUs.</li>

<li><a href="https://en.wikipedia.org/wiki/Speculative_execution">https://en.wikipedia.org/wiki/Speculative_execution</a>  Recommended Reading</li>
<li><a href="https://spectreattack.com/spectre.pdf">https://spectreattack.com/spectre.pdf</a></li>
<li><a href="http://www.goodmath.org/blog/2018/01/03/a-gentle-explanation-of-the-intel-speculative-execution-cpu-bug/">http://www.goodmath.org/blog/2018/01/03/a-gentle-explanation-of-the-intel-speculative-execution-cpu-bug/</a></li>
</ol>
</div>
</div>

<div id="outline-container-orgf9d5af8" class="outline-3">
<h3 id="orgf9d5af8"><span class="section-number-3">5.3</span> Meltdown</h3>
<div class="outline-text-3" id="text-5-3">
<ol class="org-ol">
<li>"The security of computer systems fundamentally relies on memory
isolation, e.g., kernel address ranges are marked as non-accessible
and are protected from user access. In this paper, we present
Meltdown. Meltdown exploits side effects of out-of-order execution
on modern processors to read arbitrary kernel-memory locations
including personal data and passwords. Out-of-order execution is an
indispensable performance feature and present in a wide range of
modern processors. The attack is independent of the operating
system, and it does not rely on any software
vulnerabilities. Meltdown breaks all security assumptions given by
address space isolation as well as paravirtualized environments
and, thus, every security mechanism building upon this foundation.
On affected systems, Meltdown enables an adversary to read memory
of other processes or virtual machines in the cloud without any
permissions or privileges, affecting millions of customers and
virtually every user of a personal computer. We show that the
KAISER defense mechanism for KASLR has the important (but
inadvertent) side effect of impeding Meltdown. We stress that
KAISER must be deployed immediately to prevent large-scale
exploitation of this severe information leakage."</li>

<li>Reproduced above: Abstract of: Lipp, Moritz, Michael Schwarz,
Daniel Gruss, Thomas Prescher, Werner Haas, Stefan Mangard, Paul
Kocher, Daniel Genkin, Yuval Yarom, and Mike Hamburg. "Meltdown."
arXiv preprint arXiv:1801.01207
(2018). <a href="https://meltdownattack.com/meltdown.pdf">https://meltdownattack.com/meltdown.pdf</a>, 16pp.  Reference.</li>

<li>"Practical attacks that exploit speculative execution can leak
confidential information via microarchitectural side channels.  The
recently-demonstrated Spectre attacks leverage speculative loads
which circumvent access checks to read memory-resident secrets,
transmitting them to an attacker using cache timing or other covert
communication channels.  We introduce Spectre1.1, a new Spectre-v1
variant that leverages speculative stores to create speculative
buffer overflows.  Much like classic buffer overflows, speculative
out-ofbounds stores can modify data and code pointers. Data-value
attacks can bypass some Spectre-v1 mitigations, either directly or
by redirecting control flow. Control-flow attacks enable arbitrary
speculative code execution, which can bypass fence instructions and
all other software mitigations for previous speculative-execution
attacks. It is easy to construct return-oriented-programming (ROP)
gadgets that can be used to build alternative attack payloads.  We
also present Spectre1.2: on CPUs that do not enforce read/write
protections, speculative stores can overwrite readonly data and
code pointers to breach sandboxes.  We highlight new risks posed by
these vulnerabilities, discuss possible software mitigations, and
sketch microarchitectural mechanisms that could serve as hardware
defenses.  We have not yet evaluated the performance impact of our
proposed software and hardware mitigations. We describe the salient
vulnerability features and additional hypothetical attack scenarios
only to the detail necessary to guide hardware and software vendors
in threat analysis and mitigations.  We advise users to refer to
more user-friendly vendor recommendations for mitigations against
speculative buffer overflows or available patches."</li>

<li>Reproduced above Abstract of: Kiriansky, V. and Waldspurger,
C., 2018. Speculative buffer overflows: Attacks and defenses.
arXiv:1807.03757. <a href="https://people.csail.mit.edu/vlk/spectre11.pdf">https://people.csail.mit.edu/vlk/spectre11.pdf</a>,
12pp.  Reference.</li>
</ol>
</div>


<div id="outline-container-orga21657d" class="outline-4">
<h4 id="orga21657d"><span class="section-number-4">5.3.1</span> Ideas</h4>
<div class="outline-text-4" id="text-5-3-1">
<ol class="org-ol">
<li>Out-of-Order Execution</li>
<li>Speculative Execution</li>
<li>Address Space Isolation</li>
<li>Paravirtualized Environments</li>
<li>Required: Become familiar.</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgb1bddbe" class="outline-3">
<h3 id="orgb1bddbe"><span class="section-number-3">5.4</span> Dirty COW</h3>
<div class="outline-text-3" id="text-5-4">
<ol class="org-ol">
<li>COW == Copy-on-Write, a virtual memory technique.  Pages are shared
among processes, assuming read-only.  When a page changes, it is
unshared, and a separate page is copied.</li>
<li><a href="https://dirtycow.ninja/">https://dirtycow.ninja/</a> CVE-2016-5195 is a
privilege escalation vulnerability in the Linux Kernel.</li>

<li>"The Dirty COW exploit is a race condition that allows an attacker
to gain root access to any vulnerable system, and can even be
exploited from within a Docker container. This vulnerability
existed in the Linux kernel for nine years before it was
discovered."</li>

<li>"A race condition was found in the way the Linux kernel's memory
subsystem handled the copy-on-write (COW) breakage of private
read-only memory mappings."</li>

<li>download the dirtycow exploit from
<a href="https://www.exploit-db.com/exploits/40839/">https://www.exploit-db.com/exploits/40839/</a></li>
<li>more dirtycow exploits
<a href="https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs">https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs</a></li>

<li><a href="https://01.org/developerjourney/recipe/demonstrating-dirty-cow-exploit">https://01.org/developerjourney/recipe/demonstrating-dirty-cow-exploit</a></li>
</ol>
</div>
</div>

<div id="outline-container-org49ba6de" class="outline-3">
<h3 id="org49ba6de"><span class="section-number-3">5.5</span> CVE-2017-18202 Local DoS Vulnerability</h3>
<div class="outline-text-3" id="text-5-5">
<ol class="org-ol">
<li>Linux kernel is designed to kill a process when memory runs "low".
The <code>__oom_reap_task_mm</code> function in <code>mm/oom_kill.c</code> in the Linux
kernel mishandled gather operations, which allows attackers to
cause a denial of service (TLB entry leak or use-after-free) or
possibly have unspecified other impact by triggering a
<code>copy_to_user</code> call within a certain time window.</li>

<li>"The pricing for an exploit might be around USD $5k-$25k at the
moment." [from <a href="https://vuldb.com/?id.113899">https://vuldb.com/?id.113899</a>]  Required Reading.</li>

<li><a href="https://www.securityfocus.com/bid/103161">https://www.securityfocus.com/bid/103161</a> Local DoS Vulnerability.
Reference.</li>
</ol>
</div>
</div>



<div id="outline-container-orge85868f" class="outline-3">
<h3 id="orge85868f"><span class="section-number-3">5.6</span> CVE-2017-15126</h3>
<div class="outline-text-3" id="text-5-6">
<ol class="org-ol">
<li>The security issue in this kernel vulnerability is local memory
corruption due to
<a href="http://cwe.mitre.org/data/definitions/416.html">use-after-free
(CWE\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\&#x00ad;416)</a> coding sloppiness.  Such a bug can be exploited to
execute arbitrary code.</li>

<li>The flaw was discovered in <code>fs/userfaultfd.c</code> in Linux kernel
related to <code>fork()</code> failure when dealing with event
messages.</li>

<li>The vulnerability and its fix have been published on a number of
security advisories.</li>
</ol>
</div>
</div>

<div id="outline-container-org275b962" class="outline-3">
<h3 id="org275b962"><span class="section-number-3">5.7</span> CVE-2017-1000253</h3>
<div class="outline-text-3" id="text-5-7">
<ol class="org-ol">
<li>PIE <code>load_elf_binary</code> does not allocate sufficient space.</li>

<li>Apllications are often built as a Position Independent Executable
(PIE).  The loader can allow part of that application's data
segment to map over the memory area reserved for its stack
resulting in corruption of the stack, with possible privilege
escalation.</li>
</ol>
</div>
</div>

<div id="outline-container-org8de4633" class="outline-3">
<h3 id="org8de4633"><span class="section-number-3">5.8</span> CVE  1999 to 2019</h3>
<div class="outline-text-3" id="text-5-8">
<ol class="org-ol">
<li><a href="https://www.cvedetails.com/product/47/Linux-Linux-Kernel.html">https://www.cvedetails.com/product/47/Linux-Linux-Kernel.html</a> Linux
Kernel Vulnerability Statistics 1999 - 2018.  Required Visit.</li>
<li>2019    Total number of vulnerabilities : 662
<a href="https://www.cvedetails.com/vulnerability-list/vendor_id-33/product_id-47/cvssscoremin-7/cvssscoremax-7.99/Linux-Linux-Kernel.html">https://www.cvedetails.com/vulnerability-list/vendor_id-33/product_id-47/cvssscoremin-7/cvssscoremax-7.99/Linux-Linux-Kernel.html</a> Required Visit.</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orga5f0932" class="outline-2">
<h2 id="orga5f0932"><span class="section-number-2">6</span> References</h2>
<div class="outline-text-2" id="text-6">
<ol class="org-ol">
<li>Several refs are embedded in the above.  Some (not all) of these
appear below again.</li>

<li><a href="https://www.cvedetails.com/product/47/Linux-Linux-Kernel.html">https://www.cvedetails.com/product/47/Linux-Linux-Kernel.html</a> Linux
Kernel Vulnerability Statistics 1999 - 2018.  Required Visit.</li>

<li><a href="https://blog.qualys.com/securitylabs/2017/06/19/the-stack-clash">https://blog.qualys.com/securitylabs/2017/06/19/the-stack-clash</a>;
<a href="https://www.qualys.com/2017/06/19/stack-clash/stack-clash.txt">https://www.qualys.com/2017/06/19/stack-clash/stack-clash.txt</a>
Qualys Security Advisory: The Stack Clash.    Reference.</li>

<li><a href="https://www.cvedetails.com/cve/CVE-2017-1000364/">https://www.cvedetails.com/cve/CVE-2017-1000364/</a> Stack Clash.   Reference.</li>

<li><a href="https://forum.xda-developers.com/android/software-hacking/development-stack-clash-eop-exploit-t3631001">https://forum.xda-developers.com/android/software-hacking/development-stack-clash-eop-exploit-t3631001</a>   Reference.</li>

<li><a href="https://people.csail.mit.edu/vlk/spectre11.pdf">https://people.csail.mit.edu/vlk/spectre11.pdf</a>   Reference.</li>
<li><a href="https://meltdownattack.com/">https://meltdownattack.com/</a>   Reference.</li>

<li><a href="https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails">https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails</a>
The bug has existed since around 2.6.22 (released in 2007) and was
fixed on Oct 18, 2016. Reference.</li>

<li>Spectre Mitigations <a href="https://www.wasmjit.org/blog/spectre-mitigations-part-1.html">https://www.wasmjit.org/blog/spectre-mitigations-part-1.html</a> + <a href="https://www.wasmjit.org/blog/spectre-mitigations-part-2.html">https://www.wasmjit.org/blog/spectre-mitigations-part-2.html</a></li>
</ol>
</div>

<div id="outline-container-org22085c9" class="outline-3">
<h3 id="org22085c9"><span class="section-number-3">6.1</span> References</h3>
<div class="outline-text-3" id="text-6-1">
<ol class="org-ol">
<li><a href="https://www.cvedetails.com/product/47/Linux-Linux-Kernel.html">https://www.cvedetails.com/product/47/Linux-Linux-Kernel.html</a> Linux
Kernel Vulnerability Statistics 1999 - 2018.  Required Visit.</li>

<li><a href="https://en.wikipedia.org/wiki/Linux_malware">https://en.wikipedia.org/wiki/Linux_malware</a> Required Reading.</li>

<li><a href="https://www.researchgate.net/publication/305469492">https://www.researchgate.net/publication/305469492</a> TBD
<a href="https://www.researchgate.net/profile/Reiner_Creutzburg/publication/305469492_Handbook_of_Malware_2016_-_A_Wikipedia_Book/links/578fe89e08ae64311c0c79b8/Handbook-of-Malware-2016-A-Wikipedia-Book.pdf">https://www.researchgate.net/profile/Reiner_Creutzburg/publication/305469492_Handbook_of_Malware_2016_-_A_Wikipedia_Book/links/578fe89e08ae64311c0c79b8/Handbook-of-Malware-2016-A-Wikipedia-Book.pdf</a>
Handbook of Malware 2016 - A Wikipedia Book, 232 pp, free PDF.</li>

<li><a href="https://www.sans.org/reading-room/whitepapers/malicious/exploits-yesteryear-36527">https://www.sans.org/reading-room/whitepapers/malicious/exploits-yesteryear-36527</a>
Exploits of Yesteryear Are Never Truly Gone, Marsha Miller,
mmiller@mastersprogram.sans.edu</li>
</ol>
</div>
</div>

<div id="outline-container-org16e8fb9" class="outline-3">
<h3 id="org16e8fb9"><span class="section-number-3">6.2</span> References</h3>
<div class="outline-text-3" id="text-6-2">
<ol class="org-ol">
<li><a href="https://www.cvedetails.com/product/47/Linux-Linux-Kernel.html">https://www.cvedetails.com/product/47/Linux-Linux-Kernel.html</a> Linux
Kernel Vulnerability Statistics 1999 - 2018.  Required Visit.</li>

<li><a href="https://courses.linuxchix.org/kernel-hacking-2002/08-overview-kernel-source.html">https://courses.linuxchix.org/kernel-hacking-2002/08-overview-kernel-source.html</a>
LinuxChix Kernel Hacking Lessons. 2002</li>

<li><a href="https://kernelnewbies.org/KernelHacking">https://kernelnewbies.org/KernelHacking</a> Background on kernel
development 2017 &#x2013;</li>

<li><a href="https://github.com/xairy/kernel-exploits">https://github.com/xairy/kernel-exploits</a> "A bunch of
proof-of-concept exploits for the Linux kernel" 2016 &#x2013; current.</li>
</ol>
</div>
</div>


<div id="outline-container-org70cf60b" class="outline-3">
<h3 id="org70cf60b"><span class="section-number-3">6.3</span> References</h3>
<div class="outline-text-3" id="text-6-3">
<ol class="org-ol">
<li><a href="https://www.vulnhub.com/">https://www.vulnhub.com/</a> Vulnerable Kernels by Design for
educational purposes.</li>

<li>Rashid Feroze,
<a href="https://payatu.com/guide-linux-privilege-escalation/">https://payatu.com/guide-linux-privilege-escalation/</a> 2018.  Poorly
written.  But, &#x2026; Names and links exploits.</li>
</ol>
</div>
</div>

<div id="outline-container-org95f3aa5" class="outline-3">
<h3 id="org95f3aa5"><span class="section-number-3">6.4</span> References</h3>
<div class="outline-text-3" id="text-6-4">
<ol class="org-ol">
<li><a href="https://www.cvedetails.com/product/47/Linux-Linux-Kernel.html">https://www.cvedetails.com/product/47/Linux-Linux-Kernel.html</a> Linux
Kernel Vulnerability Statistics 1999 - 2018.  Required Visit.</li>

<li><a href="https://courses.linuxchix.org/kernel-hacking-2002/08-overview-kernel-source.html">https://courses.linuxchix.org/kernel-hacking-2002/08-overview-kernel-source.html</a>
LinuxChix Kernel Hacking Lessons. 2002</li>

<li><a href="https://kernelnewbies.org/KernelHacking">https://kernelnewbies.org/KernelHacking</a> Background on kernel
development 2017 &#x2013;</li>

<li><a href="https://github.com/xairy/kernel-exploits">https://github.com/xairy/kernel-exploits</a> "A bunch of
proof-of-concept exploits for the Linux kernel" 2016 &#x2013; current.</li>
</ol>
</div>
</div>

<div id="outline-container-org4cbede5" class="outline-3">
<h3 id="org4cbede5"><span class="section-number-3">6.5</span> Related Lecture Notes</h3>
<div class="outline-text-3" id="text-6-5">
<ol class="org-ol">
<li><a href="../Hardening/BuildKernel">../Hardening/BuildKernel</a> Overview of Kernel Source and How to Build
a Kernel</li>
<li><a href="../Hardening/Kernel">../Hardening/Kernel</a> Applying patches, Building the hardened Kernel,
Deploying the Kernel</li>
</ol>
</div>
</div>
</div>




<div id="outline-container-orgce4227c" class="outline-2">
<h2 id="orgce4227c"><span class="section-number-2">7</span> End</h2>
<div class="outline-text-2" id="text-7">
</div>
</div>
</div>
<div id="postamble" class="status">
<hr size=1>Copyright &copy; 2019 <a href="http://www.wright.edu/~pmateti">www.wright.edu/~pmateti</a> &bull; 2019-10-12
</div>
</body>
</html>

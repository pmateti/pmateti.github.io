<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-12-12 Thu 14:39 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CEG4420/6420 Final Exam [TBD][WIP] Dec 14, 2018</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Prabhaker Mateti" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<style> P,li {text-align: justify} code {color: brown;} @media screen {BODY {margin: 10%} }</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="preamble" class="status">
<img src=./wsu-logo-xsm.gif border=0 width=100>
</div>
<div id="content">
<h1 class="title">CEG4420/6420 Final Exam [TBD][WIP] Dec 14, 2018</h1>
<ol class="org-ol">
<li>This exam is a traditional closed book, closed notes exam.  Once
you click the exam link, you are honor bound

<ol class="org-ol">
<li>not to surf, not to access any content already existing (TBD other
than the links given),</li>
<li>not to take longer than 120 minutes,</li>
<li>not to give or take help from others until you turnin your
answers.</li>
</ol></li>

<li>Every sentence and figure submitted is <b>your own work</b> produced
during the two hours.</li>

<li>This exam permits the use of a Linux/ Mac/ Windows laptop/ PC/ VCSL
running Ubuntu/ Knoppix/ Kali/ &#x2026; distros, gcc, ps, splint,
etc. but <b>not</b> man pages.</li>

<li>Submit one PDF file named <code>answers.pdf</code> into the Pilot dropbox for Final.</li>
</ol>

<div id="outline-container-orgd574884" class="outline-2">
<h2 id="orgd574884"><span class="section-number-2">1</span> Part I (5 points each)</h2>
<div class="outline-text-2" id="text-1">
<p>
The following statements may or may not be (fully or partially)
valid. (i) Explain the <span class="underline">underlined</span> technical term (also marked with ##)
occurring in each statement.  (ii) Explain/ discuss/ dispute the
statement. It is possible to write no more than, say, ten, sentences
each, and yet receive full score.
</p>

<ol class="org-ol">
<li><span class="underline">Code signing</span> ## uses symmetric key encryption and guarantees the
integrity of the software by verifying that the software has not
been modified.</li>

<li>AlephOne describes the <span class="underline">eggshell program</span> ## as "usage: eggshell [-a
&lt;alignment&gt;] [-b &lt;buffersize&gt;] [-e &lt;eggsize&gt;] [-o &lt;offset&gt;]\n".
Why do we need these arguments?</li>

<li>There are several <span class="underline">log files</span> ## within <code>/var/log/</code> directory in
all Linux systems.  These are for performance monitoring.  None of
them is useful in the context of security.</li>

<li><p>
<span class="underline">Address Space Layout Randomization</span> ## (ASLR) helps prevent
machine code injection.
</p>

<p>
TBD1. <span class="underline">ROP gadgets</span> ## Explain what stack top randomization is. Describe how/why stack top
randomization makes buffer overflow exploits difficult.
</p></li>

<li>TBD chroot</li>
</ol>
</div>
</div>

<div id="outline-container-org2fdba39" class="outline-2">
<h2 id="org2fdba39"><span class="section-number-2">2</span> Part II (15 points each)</h2>
<div class="outline-text-2" id="text-2">
<ol class="org-ol">
<li><p>
Suppose that an attacker has acquired root privileges on a Linux
system.  Suppose his/her primary goal is to obtain one hundred
userid-password combinations.  A secondary goal is to do this
without being noticed.  How will you verify that this attack has
happened?  How will you discover files that are changed, and
perhaps later replaced with originals?  Give your answers first (i)
(5 points) in English prose, then (ii) (10 points) as a <code>bash</code>
script.
</p>

<p>
TBD This exercise is a continuation of the one given in the last Mid
Semester Exam. Our attack plan is to replace the kernel and init
with Trojaned versions that are already created by the attacker and
available at <i>root</i>.-+/.-vmlinuz and <i>root</i>.-+/.-init. Assume that
these files were not detected. Assume that the existing modules and
initrd are useable with the new vmlinuz. Note the use of dot and
other characters. The replaced versions should become effective at
next boot. Give details of the attack plan, at the level of bash
scripts and invoking them at events E1 through E10 etc.
</p></li>

<li><p>
One of the hardening actions taken in modern Linux kernels is to
remove abstract devices <code>/dev/mem</code> and <code>/dev/kmem</code>. (i) Explain the
purpose of these devices as used in the past. (ii) Using an example
or two, describe an exploit that uses these devices. (iii) Discuss
if these devices can be resurrected in a running Linux system with
a modern kernel even though the kernel is compiled without them.
</p>

<p>
TBD The code of <code>get_sp()</code> as given by Aleph One is shown:
</p>
<pre class="example">
unsigned long get_sp(void) { __asm__("movl %esp,%eax"); }

</pre>
<p>
What does it "compute"? Describe an alternate but equivalent
version of <code>get_sp()</code> without using any assembly code.
</p></li>

<li>Describe the functionality of any five security related entries in
<code>/proc/sys/kernel</code></li>

<li>Describe any three of the Principles of Robust Programming of Matt
Bishop's article.</li>

<li>In the lectures on SELinux, 
<ol class="org-ol">
<li>an example on the <code>passwd</code> program was discussed.
<ol class="org-ol">
<li><code>allow passwd_t passwd_exec_t : file entrypoint;</code></li>
<li><code>allow user_t passwd_exec_t : file { getattr execute };</code></li>
<li><code>type_transition user_t passwd_exec_t : process passwd_t;</code></li>
<li><code>allow user_t passwd_exec_t : file { getattr execute };</code></li>
</ol></li>
<li>In the context of the above four rules, answer the
following:
<ol class="org-ol">
<li>(3 points) What is <i>context</i>, <i>role</i>, and <i>type</i>?  Give examples.</li>
<li>(2 points) What is the problem of domain transitions?</li>
<li>(10 points) How did the MAC rules above improve the standard
Linux (DAC) passwd security?  Why did we need four rules?
Does the order of these rules matter?</li>
</ol></li>
</ol></li>
</ol>
</div>
</div>

<div id="outline-container-orgbdcb65b" class="outline-2">
<h2 id="orgbdcb65b"><span class="section-number-2">3</span> End</h2>
<div class="outline-text-2" id="text-3">
</div>
</div>
</div>
<div id="postamble" class="status">
<hr size=1>Copyright &copy; 2018 Dr Prabhaker Mateti &bull; 2018-12-14
</div>
</body>
</html>

<html>
  <head>
    <title>CEG 4420 Computer Security Midsemester Exam by Prabhaker Mateti</title>
    <meta name="author" content="Prabhaker Mateti">
    <meta name="keywords" content=
	  "Computer security, Network security">
    <meta name="description" content=
	  "This page is part of a set of lectures notes for a course
	  on Security by Prabhaker Mateti
	  http://www.cs.wright.edu/~pmateti/">
    <meta http-equiv="Content-Style-Type" content="text/css">
    <style type="text/css">
      a:hover      { color: blue; background-color: yellow; }
      a:active     { color: white; background-color: green;}
      p { text-align: justify }
      li { text-align: justify }
      pre {border:blue 1px dotted;}
      tt {border:blue 1px dotted;}
      @media screen {BODY {margin: 10%;} }
    </style>
  </head>

  <body>
    <table border="0" width="100%" cellpadding="10">
      <tr>
	<td valign="top" width="10%">
	  <a target="_blank" href="http://www.wright.edu/">
	    <img src="./wsu-logo-xsm.gif" border="0" width="150" align="left"></a>
	</td>
	<td valign="top" width="40%">
          <h3>
	      CEG 4420/6420: Host Computer Security</h3>

          <h3>Fall 2018 &bull; Mid Semester Exam &bull; 100 points</h3>

	  <p>Due: Oct 24, 2018 11:59 PM.

	</td>
      </tr>
    </table>
    <blockquote>
      <p>This exam permits the use of a Linux/ Mac/ Windows laptop/ PC
	running Knoppix/ Kali, gcc, ps, splint, etc. but *not* man
	pages.  It is otherwise a traditional closed book, closed
	notes exam.  Once you click the
        <a href="../Exams/4420-2018-Fall-E1.html">
midterm link</a>, you are honor bound <ol type=i> <li> not to take
	longer than 120 minutes, <li> not to surf or access any
	content already existing (other than the links given), <li>
	not to give or take help from others</ol> until you turnin the
	<tt>answers.pdf</tt> on Pilot dropbox.
    </blockquote>

    <h2> Survey (0 points)</h2>
    <p>Please record your
      effort in minutes for each of the ten items below.  Other
      feedback you wish to give is also welcome.</p>
    <h2>Part I (5 points each)</h2>
    <p>The following statements may or may not be (fully or partially)
	valid.  Explain the underlined technical term</i> occurring in
	each statement.  Explain/ discuss/ dispute the statement.  It
	is <i>possible</i> to write no more than, say, ten, sentences
	each, and yet receive full score.</p>

<ol>
  <li> <tt><u>size</u> /bin/ls</tt>  showed the following today.
<table><tr><td><pre>
   text    data     bss     dec     hex filename
 126379    4728    4832  135939   21303 /bin/ls
</pre></td></tr></table> The numbers shown yesterday were
    different.  OMG! We have been
            compromised!

	  <li> <tt><u>sha512sum</u> /bin/ls</tt> showed the following today.
<table><tr><td><pre>
894d8c5493570ba4e0823cafbf06db490ba65b34372bb2f858e117409e5ff982
363a617dd7708c6d5c0476c7a2c9b18f279e60b0a65c59d18b0001404779d3e0
/bin/ls</pre></td></tr></table> The numbers shown yesterday were
different.  OMG! We have been compromised!

          <li> A <u>rootkit</u> is a collection of (short) programs
            used by super-users to repair the damage done by an
            intruder.
	  <li>From the content of <tt>sudo <u>/proc/1</u></tt> we can
	    get the exact path name of the <tt>init</tt>.

	  <li>Consider the following
	    programs: <tt>/bin/mount</tt>, <tt>/bin/umount</tt>,
            <tt>/usr/bin/sudo</tt>, <tt>/bin/cat</tt>,
            <tt>/usr/lib/virtualbox/VirtualBox</tt>.  It is
            justifiable that they should all be given <u>suid</u> root
            permissions.
      </ol>

    <h2>Part II (15 points each)</h2>

    <ol>
      <li>Consider the following ten significant events that occur in
	the rebooting of a Linux machine, currently running,
	from power on to login prompt. The events may or may not have
	occurred in the order given.  Other significant events not
	mentioned may have happened. <b>E1</b>: Root volume is mounted
	by the kernel; <b>E2</b>: Process <tt>init</tt> is created;
	<b>E3</b>: OS boot loader reads the kernel image; <b>E4</b>:
	OS Boot loader invokes the kernel; <b>E5</b>: several more
	processes are started.  <b>E6</b>: Several processes whose
	names are enclosed in brackets are
	started; <span style="background-color:yellowTBD"> (To see
	bracketed ones, list all processes.)</span>
        <b>E7</b>: BIOS/ UEFI finds the boot device. <b>E8</b>: OS
	boot loader is discovered; <b>E9</b>: All file volumes are
	unmounted.  <b>E10</b>: <tt>init</tt> is terminated.  (i) (10
	points) Order these events chronologically. (ii) (5 points)
	Explain step  <b>E9</b> further, and describe how security may have
	been breeched
	in <span style="background-color:yellowTBD"><strike>these two
	steps</strike> this step</span>.

      <li>Compile the file
	<a href=../Lectures/BufferOverflow/AlephOne/testsc.c>testsc.c</a>
	of AlephOne, and run <tt>testsc</tt> under <tt>strace</tt> in
	a modern Linux. (i) (5 points) Did the shell code get
	executed?  Explain fully.  (ii) (10 points) Explain the
	details of any two of the system calls s-traced.

      <li> In developing the various versions of exploitN.c, AlephOne
        wishes to avoid the occurrence of 0x00 in the shellcode[].
        Why?  How does he avoid it?

<li> The ascii diagram below is from the paper by AlephOne.  Explain
  fully the arrow labeled (3).
<table><tr><td>
<pre>
bottom of  DDDDDDDDEEEEEEEEEEEE  EEEE  FFFF  FFFF  FFFF  FFFF     top of
memory     89ABCDEF0123456789AB  CDEF  0123  4567  89AB  CDEF     memory
           buffer                sfp   ret   a     b     c
<------   [JJSSSSSSSSSSSSSSCCss][ssss][0xD8][0x01][0x02][0x03]
           ^|^             ^|            |
           |||_____________||____________| (1)
       (2)  ||_____________||
             |______________| (3)
top of                                                          bottom of
stack                                                               stack</pre>
</td></tr></table>

<li>Splint was run on
  <a href=../Lectures/BufferOverflow/AlephOne/exploit3.c>exploit3.c</a>
  of AlephOne.  It produced 12
  <a href=../Lectures/BufferOverflow/AlephOne/splint-on-exploit3.txt>
  code warnings</a>.  Take any two warnings, and explain how you would
  revise the code, line by line, so that the warnings no longer apply.
  Re-run splint on the revised exploit3.c, and include the output in
  the answers.pdf.


    <hr size="1">
    <a href="../copyright.html">Copyright &copy;</a>  2018
    <a href="http://www.cs.wright.edu/~pmateti" target=
       "_blank">Prabhaker Mateti</a>
  </body>
</html>
